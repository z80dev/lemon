---
title: Terminal UI
description: 'Full-featured terminal interface for Lemon'
---

The Terminal UI (TUI) provides a full-featured interactive interface for interacting with the Lemon coding agent.

## Backend Modes

The TUI supports two backend modes:

- **Local mode (default)**: Spawns `mix run scripts/debug_agent_rpc.exs --` and communicates over JSONL (stdio)
- **Server mode**: Connects to LemonControlPlane over WebSocket (`ws://localhost:4040/ws`)

## CLI Usage

```bash
# Start with default settings
./bin/lemon-dev

# Specify working directory
./bin/lemon-dev /path/to/project

# Specify AI model (provider:model_id)
./bin/lemon-dev --model anthropic:claude-sonnet-4-20250514
./bin/lemon-dev --model openai:gpt-4-turbo

# Specify provider separately
./bin/lemon-dev --provider anthropic

# Set custom base URL (for local/alternative providers)
./bin/lemon-dev --base-url http://localhost:11434/v1

# Enable debug mode
./bin/lemon-dev --debug

# Force rebuild
./bin/lemon-dev --rebuild
```

## Configuration

Lemon TUI reads settings from `~/.lemon/config.toml`, applies project overrides from `<project>/.lemon/config.toml`, then environment variables, then CLI args (highest priority).

At startup, Lemon auto-loads `<cwd>/.env` for the TUI/web bridge.

### Example Config

```toml
[providers.anthropic]
api_key = "sk-ant-..."

[providers.openai]
api_key = "sk-..."

[agent]
default_provider = "anthropic"
default_model = "claude-sonnet-4-20250514"

[tui]
theme = "lemon"
debug = false

[logging]
file = "~/.lemon/log/lemon.log"
level = "debug"

[control_plane]
ws_url = "ws://localhost:4040/ws"
token = "..."
role = "operator"
scopes = ["read", "write"]
client_id = "lemon-tui"
```

### Environment Variables

- `LEMON_DEFAULT_PROVIDER`, `LEMON_DEFAULT_MODEL`, `LEMON_THEME`, `LEMON_DEBUG`
- `LEMON_LOG_FILE`, `LEMON_LOG_LEVEL`
- `<PROVIDER>_API_KEY`, `<PROVIDER>_BASE_URL`
- Control plane: `LEMON_WS_URL`, `LEMON_WS_TOKEN`, `LEMON_WS_ROLE`, `LEMON_WS_SCOPES`, `LEMON_WS_CLIENT_ID`

## Slash Commands

Type `/help` in the TUI to see all commands:

### Session Management

| Command | Description |
|---------|-------------|
| `/abort` | Stop the current operation |
| `/reset` | Clear conversation history |
| `/save` | Save the current session |
| `/sessions` | List all saved sessions |
| `/resume [name]` | Resume a saved session |
| `/stats` | Show session statistics |
| `/debug [on\|off]` | Toggle debug mode |

### Search and Settings

| Command | Description |
|---------|-------------|
| `/search <term>` | Search conversation history |
| `/settings` | Open settings overlay |

### Multi-Session

| Command | Description |
|---------|-------------|
| `/running` | List running sessions |
| `/new-session [--cwd <path>] [--model <model>]` | Start new session |
| `/switch [session_id]` | Switch to different session |
| `/close-session [session_id]` | Close a session |

### Application

| Command | Description |
|---------|-------------|
| `/restart` | Restart the agent process |
| `/quit`, `/exit`, `/q` | Exit |
| `/help` | Display help |

## Keyboard Shortcuts

### Message Input

- **Enter** — Send message
- **Shift+Enter** — Insert newline

### Session Management

- **Ctrl+N** — Create new session
- **Ctrl+Tab** — Cycle through sessions

### Tool Output

- **Ctrl+O** — Toggle tool output panel

### Application Control

- **Ctrl+C** (once, empty editor) — Show quit hint
- **Ctrl+C** (twice) — Exit
- **Esc** (once, during execution) — Show abort hint
- **Esc** (twice) — Abort operation
- **Escape** — Cancel/close overlays

## Key Features

- **Real-time Streaming**: Watch LLM responses appear character-by-character
- **Tool Execution Visualization**: Dedicated panel showing tool execution
- **Multi-Session Management**: Run multiple independent sessions
- **Markdown Rendering**: Syntax highlighting and formatting
- **Overlay Dialogs**: Interactive select, confirm, input, editor
- **Session Persistence**: Save/resume with full conversation tree
- **Search**: Search across conversation history
- **Settings Management**: Themes (lemon/lime), debug mode
- **Git Integration**: Branch and status in status bar
- **Token Tracking**: Real-time tokens and cost estimate
- **Auto-Completion**: Smart completion for commands and paths
- **Debug Mode**: Internal events and diagnostics
- **Prompt Caching Metrics**: Track cache read/write tokens
